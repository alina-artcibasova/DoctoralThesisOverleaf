The mass-spring mathematical model for capsid breakage represents a rectangular fragment of the capsid at the stage when it is exposed via the fusion pore and is interacting with host molecular motors, which pull it apart (Figure 2A).

Capsid M1 proteins (the masses) are arranged in a regular mesh approximately of the size of the fusion pore (see Table S1 for all parameter values). Edge nodes of the mesh are bound to the lipid bilayer of the viral envelope/endosome and inner nodes are exposed to the cytoplasm. Here, we used a 6x6 mesh with 4x4 inner capsid proteins. Each inner mass is computed as the sum of protein masses bound to a particular node. For example, a free capsid node would simply correspond to the M1 protein mass, while a node attached to a myosin motor would have a total mass equal to the sum of masses of M1 protein, HDAC6, Ub, and myosin. Each edge node mass is the average mass of the endosome divided by the number of edge nodes.

The masses are connected to each other with elastic bonds, which we represent as a Morse potential that can explicitly include effects of bond breaking. Specifically, the Morse potential is

$V_{Morse} (r) = D_e (1 - \exp(-a(r - r_e)^2))$ , with  $a = \sqrt{\frac{k^2_e}{D_e}}$,

which has two parameters: stiffness $k_e$ and dissociation energy $D_e$. In this model we use two sets of Morse parameters for inner and outer nodes.

Each of the inner nodes of the capsid is acted on by the elastic forces of the 4 springs connecting it to other nodes. We calculate the change in spring length between two nodes as

$\delta l = \sqrt{(\delta x)^2 + (\delta y)^2} - l_{equilibrium}$ ,
 
where $\delta x = x_{neighbor} - x_{current}$ and $\delta y = y_{neighbor} - y_{current}$ are the differences between the x and y coordinates of the neighbor node and the current node, and $l_{equilibrium}$ is the equilibrium spring length. The change in spring length $\delta l$ determines the force acting on the node, created by each particular spring. We compute the force as

$f_{Morse spring} = -2 a^{type} D^{type} \exp(-a^{type} \delta l) (1 - \exp(-a^{type} \delta l))$,
 
where $a^{type}$ and $D^{type}$ are the parameters of the Morse spring, depending on the spring’s type (inner nodes corresponding to capsid parameters and edge nodes to capsid with lipid bilayer cover).

We then compute the projections on the x and the y axis of the acceleration created by each of the spring forces as follows:

$a^{spring}_z = \frac{f_{Morse spring}}{m_{node}} (\frac{-\delta z}{(\delta x)^2 + (\delta y)^2})$ ,

where $m_{node}$ is the node’s mass and $z$ stands for either x or  y.

Finally, the ODE system for one node looks as follows

\begin{equation}
\frac{d}{dt}
\begin{pmatrix}
position x\\
position y\\
velocity x\\
velocity y\\
time
\end{pmatrix}
=
\begin{pmatrix}
velocity x\\
velocity y\\
a^{top}_x + a^{right}_x + a^{bottom}_x + a^{left}_x + \frac{f^{motor}_x}{m_{node}}\\
a^{top}_y + a^{right}_y + a^{bottom}_y + a^{left}_y + \frac{f^{motor}_y}{m_{node}}\\
1
\end{pmatrix}
\end{equation}

We model the cytoskeleton near the fusion pore by a single, randomly directed microtubule, and by a denser network of actin filaments with a nucleation point on one of the edge nodes. Molecular motors are directly or indirectly (which we do not distinguish in this model) connected to the exposed capsid M1 proteins and to the cytoskeleton, allowing them to exert forces on the capsid. Specifically, dynein motors can walk in a single direction along the microtubule, while myosin motors can walk along actin filaments in random directions away from the nucleation point. Dyneins can connect to any of the inner nodes, but they can only exert forces on the capsid if they fall within the microtubular area of effect, determined by its width (Figure 2A).
We compute the resulting forces through a tug-of-war model with experimentally determined motor characteristics \cite{gennerich2007force, muller2008tug, norstrom2010unconventional}, which we modified to represent dyneins, kinesins, and positive- and negative-direction myosins. Importantly, the model considers that the force exerted by each individual motor depends on all the other motors bound to the same cargo.
First, let us examine the one-dimensional case, where all the motors walk along the microtubule. Analogously to the two-motor scenario  \cite{gennerich2007force, muller2008tug, norstrom2010unconventional}, we write a force balance.

\begin{equation}
n_kf_k + n_{m+}f_{m+} = -n_df_d - n_{m-}f_{m-} = f_C(n_k, n_d, n_{m+}, n_{m-})
\end{equation}

where $n_k$, $n_d$, $n_{m+}$, $n_{m-}$ are motor numbers and $f_k$, $f_d$, $f_{m+}$, $f_{m-}$ are forces of kinesin, dynein, plus- and minus-end myosin motors, respectively. The cargo force is determined by the condition that all motors move with the same velocity $v_C$ , as given by

\begin{equation}
v_C(n_k, n_d, n_{m+}, n_{m-}) = v_k(f_k) = v_{m+}(f_{m+}) = - v_d(f_d) = - v_{m-}(f_{m-})
\end{equation}

With this definition follows for the left part of the force balance equation Eq. (0.1)

\begin{equation}
f_C(n_k, n_d, n_{m+}, n_{m-}) = n_kf_k + n_{m+}f_{m+} = n_kf_k\big(1 + \frac{n_{m+}f_{m+}}{n_kf_{k}}\big)
\end{equation},

which gives us an expression for the kinesin force:

\begin{equation}
f_k = \frac{f_C(n_k, n_d, n_{m+}, n_{m-})}{n_k\big(1 + \frac{n_{m+}f_{m+}}{n_kf_{k}}\big)}
\end{equation}.

Analogously, for the right part and the dynein force, we obtain:

\begin{equation}
f_d = -\frac{f_C(n_k, n_d, n_{m+}, n_{m-})}{n_d\big(1 + \frac{n_{m-}f_{m-}}{n_df_{d}}\big)}
\end{equation}.

For simplicity, we assume here that the ratio of motor forces moving in the same direction is proportionate to the ratio of their stall forces (indicated by subscript S):

\begin{equation}
\frac{f_{m+}}{f_k} \propto \frac{f_{Sm+}}{f_{Sk}}, 
\frac{f_{m-}}{f_d} \propto \frac{f_{Sm-}}{f_{Sd}}
\end{equation}

This allows us to write the expressions for kinesin and dynein forces as follows

\begin{equation}
f_k = \frac{f_C(n_k, n_d, n_{m+}, n_{m-})}{n_kC_k(n_{m+}, n_k)}
\end{equation}

\begin{equation}
f_d = -\frac{f_C(n_k, n_d, n_{m+}, n_{m-})}{n_dC_d(n_{m-},n_d)}
\end{equation}

where

\begin{equation}
C_k(n_{m+}, n_k) = 1 + \frac{n_{m+}f_{Sm+}}{n_kf_{Sk}}
\end{equation}

\begin{equation}
C_d(n_{m-},n_d) = 1 + \frac{n_{m-}f_{Sm-}}{n_df_{Sd}}
\end{equation}

We know that the velocity of a motor can be expressed as a function of the load force \cite{muller2008tug}:

\begin{equation}
v(f) = \left\{ \begin{aligned}
v_{forward} (1 - \frac{|f|}{f_S}), for 0 \leq  f \leq f_S\\
v_{backward} (1 - \frac{f}{f_S}), for f > f_S
\end{aligned}\right.
\end{equation}

Now we can use the expression for the cargo velocity to derive:

\begin{equation}
v_C(n_k, n_d, n_{m+}, n_{m-}) = v_k(f_k) = - v_d(-f_d)
\end{equation}

\begin{equation}
\begin{split}
v_C(n_k, n_d, n_{m+}, n_{m-}) = v_{0k}\big(1-\frac{f_k}{f_{Sk}}\big) =\\
v_{0k}\big(1-\frac{1}{f_{Sk}}\frac{f_C(n_k, n_d, n_{m+}, n_{m-})}{n_kC_k(n_{m+}, n_k)} = \\
v_{0k}-\frac{v_{0k}}{f_{Sk}}\frac{f_C(n_k, n_d, n_{m+}, n_{m-})}{n_kC_k(n_{m+}, n_k)}
\end{split}
\end{equation}

\begin{equation}
\begin{split}
v_C(n_k, n_d, n_{m+}, n_{m-}) = -v_{0d}\big(1-\frac{f_d}{f_{Sd}}\big) =\\ -v_{0d}\big(1-\frac{1}{f_{Sd}}\frac{f_C(n_k, n_d, n_{m+}, n_{m-})}{n_dC_d(n_{m-},n_d)}\big) = \\
-\big(v_{0d}-\frac{v_{0d}}{f_{Sd}}\frac{f_C(n_k, n_d, n_{m+}, n_{m-})}{n_dC_d(n_{m-},n_d)}\big)
\end{split}
\end{equation}

\begin{equation}
\begin{split}
v_C(n_k, n_d, n_{m+}, n_{m-}) =\\ v_{0k}-\frac{v_{0k}}{f_{Sk}}\frac{f_C(n_k, n_d, n_{m+}, n_{m-})}{n_kC_k(n_{m+}, n_k)} =
-\big(v_{0d}-\frac{v_{0d}}{f_{Sd}}\frac{f_C(n_k, n_d, n_{m+}, n_{m-})}{n_dC_d(n_{m-},n_d)}\big)
\end{split}
\end{equation}


By shuffling the second and third terms in this equation, we get the expression for the cargo force
 ,
 ,
 .
Now, for convenience we rewrite the equation:
 ,
 ,
 ,
to get the following expression for cargo force as a function of motor abundances
 , 
where
 .
After computing the cargo force, we can calculate the expressions for the kinesin and dynein forces:
 ,  ,
and using those expressions, the expressions for myosin forces
 ,  .
In the two-dimensional case, dyneins and kinesins would still be walking along the microtubule, such that only the expressions for the myosins would change. Myosin forces are involved in the calculation of   and  , but if we examine the formulas, we see that   are simply cumulative forces created by plus- and minus-end myosin motors. Thus, we can easily substitute these terms for  , where   is a projection of the stall force of a motor   on the direction of the microtubule. Similarly, expressions for myosin forces are computed individually for each motor with   being substituted by the projection .
To avoid division by zero, in simulations we assume that there are always one dynein and one kinesin bound to the endosome outside of the fusion pore because the endosome had to be transported inside the cell to initiate fusion pore formation. Due to the architecture of the Tug-of-War model and since all the microtubular motors can only generate forces along the microtubule, adding more endosomal motors would simply offset the optimal amount of dynein motors required for efficient breakage. All other motors are bound to the capsid from the very start of the simulation.
For simplicity, here we disregard tug-of-war between myosins in the direction perpendicular to the microtubule. However, this interaction can be computed and included into simulations similarly, by using the results of (Gennerich et al., 2007; Muller et al., 2008; Norstrom et al., 2010) for two motors:
 , where  .
Like before, we substitute   for  , where   are projections of the stall force of motor i in the direction perpendicular to the microtubule. Knowing  , we can compute the motor forces as:
 ,  .
During simulations of the mass-spring model, each motor configuration has a fixed number of each type of motor, but the placement and the directions of cytoskeletal filaments are randomized. The model is simulated for one microsecond of system time at least 100 times for each motor configuration using the MATLAB ODE solver ode15s (Mathworks, Natick / MA).
After a simulation, we examine the distance between all neighboring nodes in both   and   directions. If during the simulation the combined motor forces were sufficient to make any of the distances exceed the RNP complex diameter (a mock-up example for the one-dimensional case of break/no break scenarios showed in Figure S1A) for at least half the simulated system time (to avoid counting transient breaks), we classified the capsid as broken. Usually, however, if capsid breakage occurs, the initial break happens early in the simulation and persists through 80-90% of the simulation time (Figure S1B).
To analyze the robustness of the simulation results to changes in capsid parameters, we fixed a combination of motors (5 myosins and 1 dynein) that produced approximately 50% breakage, and varied the capsid bond parameters stiffness   and dissociation energy  . The values used in our simulations were  [0.001, 0.002, 0.003, 0.004, 0.005] N/m and  [10, 12, 14, 16, 18, 20] kJ, where boldface indicates the default values (Figure S1C).
To simplify computation of the capsid breakage probability, we interpolated it as a function of the total amount of molecular motors and the number of dynein motors using the R package akima on the basis of the values obtained from simulation of the mass-spring model (Figure S1D).
